"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var sqlite = require("nativescript-sqlite");
var interest_1 = require("./interest");
var InterestDatabaseService = (function () {
    function InterestDatabaseService() {
        console.log("In Interest DB Service Constructor");
    }
    // create a table
    InterestDatabaseService.prototype.createTable = function () {
        new sqlite("interest.db", function (err, db) {
            db.execSQL("CREATE TABLE IF NOT EXISTS Interest (id INTEGER PRIMARY KEY, customer_id TEXT, beacon TEXT, start DATETIME,end DATETIME,creating NUMERIC, active NUMERIC, keywords JSON )", [], function (err) {
                console.log("TABLE Interest CREATED");
                return true;
            });
        });
    };
    // drops a table
    InterestDatabaseService.prototype.dropTable = function () {
        new sqlite("interest.db", function (err, db) {
            db.execSQL("DROP TABLE IF EXISTS Interest", [], function (err) {
                console.log("TABLE Interest DROPPED");
                return true;
            });
        });
    };
    InterestDatabaseService.prototype.insertInterest = function (interest) {
        console.log("Attempting to insert: " + interest.id);
        new sqlite("interest.db", function (err, db) {
            db.execSQL("INSERT INTO Interest (id,customer_id,  beacon , start ,end ,creating , active , keywords ) VALUES (?,?,?,?,?,?,?,?)", [interest.id, interest.customer_id, interest.beacon, interest.start, interest.end, interest.creating, interest.active, interest.keywords], function (err, id) {
                console.log("The new record with id " + id + " and beacon " + interest.beacon);
                return true;
            });
        });
    };
    // update an existing record
    InterestDatabaseService.prototype.updateInterest = function (id, customer_id, beacon, start, end, creating, active, keywords) {
        new sqlite("interest.db", function (err, db) {
            db.execSQL("UPDATE Interest SET customer_id = ?, beacon = ?, start = ?, end = ?, creating = ?, active = ?, keywords = ? WHERE id = ?", [customer_id, beacon, start, end, creating, active, keywords, id], function (err, id) {
                console.log("The existing record id is: " + id);
                return true;
            });
        });
    };
    // delete a record
    InterestDatabaseService.prototype.deleteInterest = function (id) {
        new sqlite("interest.db", function (err, db) {
            db.execSQL("DELETE FROM Interest WHERE id = ?", [id], function (err, id) {
                console.log("The deleted record id is: " + id);
                return true;
            });
        });
    };
    // select a single record
    InterestDatabaseService.prototype.selectInterest = function (id) {
        var record;
        new sqlite("interest.db", function (err, db) {
            db.get("SELECT * FROM Interest WHERE id = ?", [id], function (err, row) {
                // console.log("Row of data was: " + row);  // Prints [["Field1", "Field2",...]] 
                // console.log("1: "+row[1]);
                record = row;
                // return row;
            });
        });
        return record;
    };
    // select a single record
    InterestDatabaseService.prototype.selectInterestByBeacon = function (beacon) {
        console.log("select beacon: " + beacon);
        var record;
        new sqlite("interest.db", function (err, db) {
            db.get("SELECT * FROM Interest WHERE beacon = ?", [beacon], function (err, row) {
                // console.log("Row of data was: " + row);  // Prints [["Field1", "Field2",...]] 
                // console.log("1: "+row[1]);
                record = row;
                // return row;
            });
        });
        console.log("record:" + record);
        return record;
    };
    // select all records
    InterestDatabaseService.prototype.selectInterests = function () {
        var interests = new Array();
        new sqlite("interest.db", function (err, db) {
            db.all("SELECT * FROM Interest ORDER BY id", [], function (err, rs) {
                rs.forEach(function (element) {
                    console.log("E0: " + element[0]);
                    console.log("E1: " + element[1]);
                    console.log("E2: " + element[2]);
                    console.log("E3: " + element[3]);
                    console.log("E4: " + element[4]);
                    console.log("E5: " + element[5]);
                    console.log("E6: " + element[6]);
                    console.log("E7: " + element[7]);
                    var interestObj = new interest_1.Interest(element[1], element[2], element[3], element[4]);
                    interestObj.id = element[0];
                    interestObj.creating = element[5];
                    interestObj.active = element[6];
                    interestObj.keywords = element[7];
                    interests.push(interestObj);
                });
            });
        });
        return interests;
    };
    InterestDatabaseService = __decorate([
        core_1.Injectable(),
        __metadata("design:paramtypes", [])
    ], InterestDatabaseService);
    return InterestDatabaseService;
}());
exports.InterestDatabaseService = InterestDatabaseService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZXJlc3QuZGIuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImludGVyZXN0LmRiLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxzQ0FBeUQ7QUFDekQsSUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFFLHFCQUFxQixDQUFFLENBQUM7QUFDaEQsdUNBQXNDO0FBR3RDO0lBRUU7UUFDSSxPQUFPLENBQUMsR0FBRyxDQUFDLG9DQUFvQyxDQUFDLENBQUM7SUFDdEQsQ0FBQztJQUVELGlCQUFpQjtJQUNqQiw2Q0FBVyxHQUFYO1FBQ0UsSUFBSSxNQUFNLENBQUMsYUFBYSxFQUFFLFVBQVMsR0FBRyxFQUFFLEVBQUU7WUFDdEMsRUFBRSxDQUFDLE9BQU8sQ0FBQywyS0FBMkssRUFBRSxFQUFFLEVBQUUsVUFBUyxHQUFHO2dCQUNwTSxPQUFPLENBQUMsR0FBRyxDQUFDLHdCQUF3QixDQUFDLENBQUM7Z0JBQ3RDLE1BQU0sQ0FBQyxJQUFJLENBQUM7WUFDaEIsQ0FBQyxDQUFDLENBQUM7UUFDUCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxnQkFBZ0I7SUFDaEIsMkNBQVMsR0FBVDtRQUNFLElBQUksTUFBTSxDQUFDLGFBQWEsRUFBRSxVQUFTLEdBQUcsRUFBRSxFQUFFO1lBQ3RDLEVBQUUsQ0FBQyxPQUFPLENBQUMsK0JBQStCLEVBQUUsRUFBRSxFQUFFLFVBQVMsR0FBRztnQkFDeEQsT0FBTyxDQUFDLEdBQUcsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFDO2dCQUN0QyxNQUFNLENBQUMsSUFBSSxDQUFDO1lBQ2hCLENBQUMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsZ0RBQWMsR0FBZCxVQUFlLFFBQWtCO1FBQy9CLE9BQU8sQ0FBQyxHQUFHLENBQUMsd0JBQXdCLEdBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQ2xELElBQUksTUFBTSxDQUFDLGFBQWEsRUFBRSxVQUFTLEdBQUcsRUFBRSxFQUFFO1lBQ3RDLEVBQUUsQ0FBQyxPQUFPLENBQUMscUhBQXFILEVBQUUsQ0FBQyxRQUFRLENBQUMsRUFBRSxFQUFDLFFBQVEsQ0FBQyxXQUFXLEVBQUUsUUFBUSxDQUFDLE1BQU0sRUFBRSxRQUFRLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxHQUFHLEVBQUUsUUFBUSxDQUFDLFFBQVEsRUFBRSxRQUFRLENBQUMsTUFBTSxFQUFFLFFBQVEsQ0FBQyxRQUFRLENBQUMsRUFBRSxVQUFTLEdBQUcsRUFBRSxFQUFFO2dCQUN4UixPQUFPLENBQUMsR0FBRyxDQUFDLHlCQUF5QixHQUFHLEVBQUUsR0FBQyxjQUFjLEdBQUMsUUFBUSxDQUFDLE1BQU0sQ0FBQyxDQUFDO2dCQUMzRSxNQUFNLENBQUMsSUFBSSxDQUFDO1lBQ2hCLENBQUMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsNEJBQTRCO0lBQzVCLGdEQUFjLEdBQWQsVUFBZSxFQUFFLEVBQUMsV0FBVyxFQUFHLE1BQU0sRUFBRyxLQUFLLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRyxNQUFNLEVBQUcsUUFBUTtRQUMvRSxJQUFJLE1BQU0sQ0FBQyxhQUFhLEVBQUUsVUFBUyxHQUFHLEVBQUUsRUFBRTtZQUN0QyxFQUFFLENBQUMsT0FBTyxDQUFDLDBIQUEwSCxFQUFFLENBQUMsV0FBVyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsR0FBRyxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsUUFBUSxFQUFFLEVBQUUsQ0FBQyxFQUFFLFVBQVMsR0FBRyxFQUFFLEVBQUU7Z0JBQ3ROLE9BQU8sQ0FBQyxHQUFHLENBQUMsNkJBQTZCLEdBQUcsRUFBRSxDQUFDLENBQUM7Z0JBQ2hELE1BQU0sQ0FBQyxJQUFJLENBQUM7WUFDaEIsQ0FBQyxDQUFDLENBQUM7UUFDUCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUM7SUFFRCxrQkFBa0I7SUFDbEIsZ0RBQWMsR0FBZCxVQUFlLEVBQUU7UUFDZixJQUFJLE1BQU0sQ0FBQyxhQUFhLEVBQUUsVUFBUyxHQUFHLEVBQUUsRUFBRTtZQUN0QyxFQUFFLENBQUMsT0FBTyxDQUFDLG1DQUFtQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsVUFBUyxHQUFHLEVBQUUsRUFBRTtnQkFDbEUsT0FBTyxDQUFDLEdBQUcsQ0FBQyw0QkFBNEIsR0FBRyxFQUFFLENBQUMsQ0FBQztnQkFDL0MsTUFBTSxDQUFDLElBQUksQ0FBQztZQUNoQixDQUFDLENBQUMsQ0FBQztRQUNQLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQUVELHlCQUF5QjtJQUN6QixnREFBYyxHQUFkLFVBQWUsRUFBRTtRQUNmLElBQUksTUFBVyxDQUFDO1FBQ2hCLElBQUksTUFBTSxDQUFDLGFBQWEsRUFBRSxVQUFTLEdBQUcsRUFBRSxFQUFFO1lBQ3RDLEVBQUUsQ0FBQyxHQUFHLENBQUMscUNBQXFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxVQUFTLEdBQUcsRUFBRSxHQUFHO2dCQUNqRSxpRkFBaUY7Z0JBQ2pGLDZCQUE2QjtnQkFDN0IsTUFBTSxHQUFHLEdBQUcsQ0FBQztnQkFDYixjQUFjO1lBQ2xCLENBQUMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLENBQUM7UUFDSCxNQUFNLENBQUMsTUFBTSxDQUFDO0lBQ2hCLENBQUM7SUFFQyx5QkFBeUI7SUFDekIsd0RBQXNCLEdBQXRCLFVBQXVCLE1BQU07UUFDekIsT0FBTyxDQUFDLEdBQUcsQ0FBQyxpQkFBaUIsR0FBQyxNQUFNLENBQUMsQ0FBQztRQUN0QyxJQUFJLE1BQVcsQ0FBQztRQUNoQixJQUFJLE1BQU0sQ0FBQyxhQUFhLEVBQUUsVUFBUyxHQUFHLEVBQUUsRUFBRTtZQUN0QyxFQUFFLENBQUMsR0FBRyxDQUFDLHlDQUF5QyxFQUFFLENBQUMsTUFBTSxDQUFDLEVBQUUsVUFBUyxHQUFHLEVBQUUsR0FBRztnQkFDekUsaUZBQWlGO2dCQUNqRiw2QkFBNkI7Z0JBQzdCLE1BQU0sR0FBRyxHQUFHLENBQUM7Z0JBQ2IsY0FBYztZQUNsQixDQUFDLENBQUMsQ0FBQztRQUNQLENBQUMsQ0FBQyxDQUFDO1FBQ0gsT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLEdBQUUsTUFBTSxDQUFDLENBQUM7UUFDL0IsTUFBTSxDQUFDLE1BQU0sQ0FBQztJQUNoQixDQUFDO0lBRUwscUJBQXFCO0lBQ3JCLGlEQUFlLEdBQWY7UUFDRSxJQUFJLFNBQVMsR0FBRyxJQUFJLEtBQUssRUFBWSxDQUFDO1FBQ3RDLElBQUksTUFBTSxDQUFDLGFBQWEsRUFBRSxVQUFTLEdBQUcsRUFBRSxFQUFFO1lBQ3RDLEVBQUUsQ0FBQyxHQUFHLENBQUMsb0NBQW9DLEVBQUUsRUFBRSxFQUFFLFVBQVMsR0FBRyxFQUFFLEVBQUU7Z0JBQy9ELEVBQUUsQ0FBQyxPQUFPLENBQUMsVUFBQSxPQUFPO29CQUNoQixPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDL0IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEdBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQy9CLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxHQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUMvQixPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDL0IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEdBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQy9CLE9BQU8sQ0FBQyxHQUFHLENBQUMsTUFBTSxHQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUMvQixPQUFPLENBQUMsR0FBRyxDQUFDLE1BQU0sR0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDL0IsT0FBTyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEdBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQy9CLElBQUksV0FBVyxHQUFHLElBQUksbUJBQVEsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLEVBQUUsT0FBTyxDQUFDLENBQUMsQ0FBQyxFQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUMsRUFBRSxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDL0UsV0FBVyxDQUFDLEVBQUUsR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQzVCLFdBQVcsQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUNsQyxXQUFXLENBQUMsTUFBTSxHQUFHLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztvQkFDaEMsV0FBVyxDQUFDLFFBQVEsR0FBRyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7b0JBQ2xDLFNBQVMsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7Z0JBRTlCLENBQUMsQ0FBQyxDQUFDO1lBQ0wsQ0FBQyxDQUFDLENBQUM7UUFDUCxDQUFDLENBQUMsQ0FBQztRQUNILE1BQU0sQ0FBQyxTQUFTLENBQUM7SUFDbkIsQ0FBQztJQS9HVSx1QkFBdUI7UUFEbkMsaUJBQVUsRUFBRTs7T0FDQSx1QkFBdUIsQ0FpSG5DO0lBQUQsOEJBQUM7Q0FBQSxBQWpIRCxJQWlIQztBQWpIWSwwREFBdUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBFdmVudEVtaXR0ZXIgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuY29uc3Qgc3FsaXRlID0gcmVxdWlyZSggXCJuYXRpdmVzY3JpcHQtc3FsaXRlXCIgKTtcbmltcG9ydCB7IEludGVyZXN0IH0gZnJvbSBcIi4vaW50ZXJlc3RcIjtcblxuQEluamVjdGFibGUoKVxuZXhwb3J0IGNsYXNzIEludGVyZXN0RGF0YWJhc2VTZXJ2aWNlIHtcblxuICBwdWJsaWMgY29uc3RydWN0b3IoKSB7XG4gICAgICBjb25zb2xlLmxvZyhcIkluIEludGVyZXN0IERCIFNlcnZpY2UgQ29uc3RydWN0b3JcIik7XG4gIH1cblxuICAvLyBjcmVhdGUgYSB0YWJsZVxuICBjcmVhdGVUYWJsZSgpIHtcbiAgICBuZXcgc3FsaXRlKFwiaW50ZXJlc3QuZGJcIiwgZnVuY3Rpb24oZXJyLCBkYikge1xuICAgICAgICBkYi5leGVjU1FMKFwiQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgSW50ZXJlc3QgKGlkIElOVEVHRVIgUFJJTUFSWSBLRVksIGN1c3RvbWVyX2lkIFRFWFQsIGJlYWNvbiBURVhULCBzdGFydCBEQVRFVElNRSxlbmQgREFURVRJTUUsY3JlYXRpbmcgTlVNRVJJQywgYWN0aXZlIE5VTUVSSUMsIGtleXdvcmRzIEpTT04gKVwiLCBbXSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRBQkxFIEludGVyZXN0IENSRUFURURcIik7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgXG4gIC8vIGRyb3BzIGEgdGFibGVcbiAgZHJvcFRhYmxlKCkge1xuICAgIG5ldyBzcWxpdGUoXCJpbnRlcmVzdC5kYlwiLCBmdW5jdGlvbihlcnIsIGRiKSB7XG4gICAgICAgIGRiLmV4ZWNTUUwoXCJEUk9QIFRBQkxFIElGIEVYSVNUUyBJbnRlcmVzdFwiLCBbXSwgZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRBQkxFIEludGVyZXN0IERST1BQRURcIik7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgXG4gIGluc2VydEludGVyZXN0KGludGVyZXN0OiBJbnRlcmVzdCkge1xuICAgIGNvbnNvbGUubG9nKFwiQXR0ZW1wdGluZyB0byBpbnNlcnQ6IFwiK2ludGVyZXN0LmlkKTtcbiAgICBuZXcgc3FsaXRlKFwiaW50ZXJlc3QuZGJcIiwgZnVuY3Rpb24oZXJyLCBkYikge1xuICAgICAgICBkYi5leGVjU1FMKFwiSU5TRVJUIElOVE8gSW50ZXJlc3QgKGlkLGN1c3RvbWVyX2lkLCAgYmVhY29uICwgc3RhcnQgLGVuZCAsY3JlYXRpbmcgLCBhY3RpdmUgLCBrZXl3b3JkcyApIFZBTFVFUyAoPyw/LD8sPyw/LD8sPyw/KVwiLCBbaW50ZXJlc3QuaWQsaW50ZXJlc3QuY3VzdG9tZXJfaWQsIGludGVyZXN0LmJlYWNvbiwgaW50ZXJlc3Quc3RhcnQsIGludGVyZXN0LmVuZCwgaW50ZXJlc3QuY3JlYXRpbmcsIGludGVyZXN0LmFjdGl2ZSwgaW50ZXJlc3Qua2V5d29yZHNdLCBmdW5jdGlvbihlcnIsIGlkKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRoZSBuZXcgcmVjb3JkIHdpdGggaWQgXCIgKyBpZCtcIiBhbmQgYmVhY29uIFwiK2ludGVyZXN0LmJlYWNvbik7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgXG4gIC8vIHVwZGF0ZSBhbiBleGlzdGluZyByZWNvcmRcbiAgdXBkYXRlSW50ZXJlc3QoaWQsY3VzdG9tZXJfaWQsICBiZWFjb24gLCBzdGFydCAsZW5kICxjcmVhdGluZyAsIGFjdGl2ZSAsIGtleXdvcmRzKSB7XG4gICAgbmV3IHNxbGl0ZShcImludGVyZXN0LmRiXCIsIGZ1bmN0aW9uKGVyciwgZGIpIHtcbiAgICAgICAgZGIuZXhlY1NRTChcIlVQREFURSBJbnRlcmVzdCBTRVQgY3VzdG9tZXJfaWQgPSA/LCBiZWFjb24gPSA/LCBzdGFydCA9ID8sIGVuZCA9ID8sIGNyZWF0aW5nID0gPywgYWN0aXZlID0gPywga2V5d29yZHMgPSA/IFdIRVJFIGlkID0gP1wiLCBbY3VzdG9tZXJfaWQsIGJlYWNvbiwgc3RhcnQsIGVuZCwgY3JlYXRpbmcsIGFjdGl2ZSwga2V5d29yZHMsIGlkXSwgZnVuY3Rpb24oZXJyLCBpZCkge1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJUaGUgZXhpc3RpbmcgcmVjb3JkIGlkIGlzOiBcIiArIGlkKTtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxuICBcbiAgLy8gZGVsZXRlIGEgcmVjb3JkXG4gIGRlbGV0ZUludGVyZXN0KGlkKSB7XG4gICAgbmV3IHNxbGl0ZShcImludGVyZXN0LmRiXCIsIGZ1bmN0aW9uKGVyciwgZGIpIHtcbiAgICAgICAgZGIuZXhlY1NRTChcIkRFTEVURSBGUk9NIEludGVyZXN0IFdIRVJFIGlkID0gP1wiLCBbaWRdLCBmdW5jdGlvbihlcnIsIGlkKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIlRoZSBkZWxldGVkIHJlY29yZCBpZCBpczogXCIgKyBpZCk7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbiAgXG4gIC8vIHNlbGVjdCBhIHNpbmdsZSByZWNvcmRcbiAgc2VsZWN0SW50ZXJlc3QoaWQpIHtcbiAgICBsZXQgcmVjb3JkOiBhbnk7XG4gICAgbmV3IHNxbGl0ZShcImludGVyZXN0LmRiXCIsIGZ1bmN0aW9uKGVyciwgZGIpIHtcbiAgICAgICAgZGIuZ2V0KFwiU0VMRUNUICogRlJPTSBJbnRlcmVzdCBXSEVSRSBpZCA9ID9cIiwgW2lkXSwgZnVuY3Rpb24oZXJyLCByb3cpIHtcbiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiUm93IG9mIGRhdGEgd2FzOiBcIiArIHJvdyk7ICAvLyBQcmludHMgW1tcIkZpZWxkMVwiLCBcIkZpZWxkMlwiLC4uLl1dIFxuICAgICAgICAgICAgLy8gY29uc29sZS5sb2coXCIxOiBcIityb3dbMV0pO1xuICAgICAgICAgICAgcmVjb3JkID0gcm93O1xuICAgICAgICAgICAgLy8gcmV0dXJuIHJvdztcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJlY29yZDtcbiAgfVxuXG4gICAgLy8gc2VsZWN0IGEgc2luZ2xlIHJlY29yZFxuICAgIHNlbGVjdEludGVyZXN0QnlCZWFjb24oYmVhY29uKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwic2VsZWN0IGJlYWNvbjogXCIrYmVhY29uKTtcbiAgICAgICAgbGV0IHJlY29yZDogYW55O1xuICAgICAgICBuZXcgc3FsaXRlKFwiaW50ZXJlc3QuZGJcIiwgZnVuY3Rpb24oZXJyLCBkYikge1xuICAgICAgICAgICAgZGIuZ2V0KFwiU0VMRUNUICogRlJPTSBJbnRlcmVzdCBXSEVSRSBiZWFjb24gPSA/XCIsIFtiZWFjb25dLCBmdW5jdGlvbihlcnIsIHJvdykge1xuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiUm93IG9mIGRhdGEgd2FzOiBcIiArIHJvdyk7ICAvLyBQcmludHMgW1tcIkZpZWxkMVwiLCBcIkZpZWxkMlwiLC4uLl1dIFxuICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFwiMTogXCIrcm93WzFdKTtcbiAgICAgICAgICAgICAgICByZWNvcmQgPSByb3c7XG4gICAgICAgICAgICAgICAgLy8gcmV0dXJuIHJvdztcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc29sZS5sb2coXCJyZWNvcmQ6XCIgK3JlY29yZCk7XG4gICAgICAgIHJldHVybiByZWNvcmQ7XG4gICAgICB9XG4gIFxuICAvLyBzZWxlY3QgYWxsIHJlY29yZHNcbiAgc2VsZWN0SW50ZXJlc3RzKCk6IEFycmF5PEludGVyZXN0PiB7XG4gICAgbGV0IGludGVyZXN0cyA9IG5ldyBBcnJheTxJbnRlcmVzdD4oKTtcbiAgICBuZXcgc3FsaXRlKFwiaW50ZXJlc3QuZGJcIiwgZnVuY3Rpb24oZXJyLCBkYikge1xuICAgICAgICBkYi5hbGwoXCJTRUxFQ1QgKiBGUk9NIEludGVyZXN0IE9SREVSIEJZIGlkXCIsIFtdLCBmdW5jdGlvbihlcnIsIHJzKSB7XG4gICAgICAgICAgcnMuZm9yRWFjaChlbGVtZW50ID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRTA6IFwiK2VsZW1lbnRbMF0pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJFMTogXCIrZWxlbWVudFsxXSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkUyOiBcIitlbGVtZW50WzJdKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRTM6IFwiK2VsZW1lbnRbM10pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJFNDogXCIrZWxlbWVudFs0XSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhcIkU1OiBcIitlbGVtZW50WzVdKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiRTY6IFwiK2VsZW1lbnRbNl0pO1xuICAgICAgICAgICAgY29uc29sZS5sb2coXCJFNzogXCIrZWxlbWVudFs3XSk7XG4gICAgICAgICAgICBsZXQgaW50ZXJlc3RPYmogPSBuZXcgSW50ZXJlc3QoZWxlbWVudFsxXSwgZWxlbWVudFsyXSwgZWxlbWVudFszXSwgZWxlbWVudFs0XSk7XG4gICAgICAgICAgICBpbnRlcmVzdE9iai5pZCA9IGVsZW1lbnRbMF07XG4gICAgICAgICAgICBpbnRlcmVzdE9iai5jcmVhdGluZyA9IGVsZW1lbnRbNV07XG4gICAgICAgICAgICBpbnRlcmVzdE9iai5hY3RpdmUgPSBlbGVtZW50WzZdO1xuICAgICAgICAgICAgaW50ZXJlc3RPYmoua2V5d29yZHMgPSBlbGVtZW50WzddO1xuICAgICAgICAgICAgaW50ZXJlc3RzLnB1c2goaW50ZXJlc3RPYmopO1xuICAgICAgICAgICAgXG4gICAgICAgICAgfSk7ICAgXG4gICAgICAgIH0pO1xuICAgIH0pO1xuICAgIHJldHVybiBpbnRlcmVzdHM7XG4gIH0gICBcblxufSJdfQ==